box: 
  id: ymotongpoo/ergodox:wercker

build:
  steps:
    - script:
        name: confirm docker image version.
        code: |
          echo /etc/lsb-release && uname -a
    - script:
        name: build default keymap.
        cwd: qmk_firmware/keyboard/ergodox_ez
        code: |
          make clean && make KEYMAP=default
    - script:
        name: move built firmware to output dir.
        cwd: $WERCKER_SOURCE_DIR/qmk_firmware/keyboard/ergodox_ez
        code: |
          mv ergodox_ez.hex $WERCKER_OUTPUT_DIR
deploy:
  steps:
    - script:
        name: put built hex file to bintray.
        code: |
          curl -T $WERCKER_SOURCE_DIR/ergodox_ez.hex -u$BINTRAY_USERNAME:$BINTRAY_APIKEY https://api.bintray.com/content/ymotongpoo/ergodox/ergodox.hex/1/ergodox.hex
